# tinyepubbuilder

A tool to make a simple epub package easily.

## Installation

```
pip install tinyepubbuilder
```

## Usage

### Quick-Usage

In the following, the `tinyepubbuild` command makes the `test.epub` file from the jpeg file list.

```
% ls *.jpg
examples/foo/00 a.jpg	examples/foo/02 c.jpg	examples/foo/04 e.jpg
examples/foo/01 b.jpg	examples/foo/03 d.jpg

% ls -1 examples/foo/*.jpg | tinyepubbuild test
tinyepubbuilder.builder.INFO: making a build dir
  -- build.tinyepubbuilder
tinyepubbuilder.builder.INFO: making a Package Document
  -- build.tinyepubbuilder/test/book/package.opf
tinyepubbuilder.builder.INFO: making a Navigation Document
  -- build.tinyepubbuilder/test/book/navigation.xhtml
tinyepubbuilder.builder.INFO: copying examples/foo/00 a.jpg to
  -- build.tinyepubbuilder/test/book/items/examples/foo/00 a.jpg
tinyepubbuilder.builder.INFO: making a page
  -- build.tinyepubbuilder/test/book/items/examples/foo/00 a.jpg.xhtml
tinyepubbuilder.builder.INFO: copying examples/foo/01 b.jpg to
  -- build.tinyepubbuilder/test/book/items/examples/foo/01 b.jpg
tinyepubbuilder.builder.INFO: making a page
  -- build.tinyepubbuilder/test/book/items/examples/foo/01 b.jpg.xhtml
tinyepubbuilder.builder.INFO: copying examples/foo/02 c.jpg to
  -- build.tinyepubbuilder/test/book/items/examples/foo/02 c.jpg
tinyepubbuilder.builder.INFO: making a page
  -- build.tinyepubbuilder/test/book/items/examples/foo/02 c.jpg.xhtml
tinyepubbuilder.builder.INFO: copying examples/foo/03 d.jpg to
  -- build.tinyepubbuilder/test/book/items/examples/foo/03 d.jpg
tinyepubbuilder.builder.INFO: making a page
  -- build.tinyepubbuilder/test/book/items/examples/foo/03 d.jpg.xhtml
tinyepubbuilder.builder.INFO: copying examples/foo/04 e.jpg to
  -- build.tinyepubbuilder/test/book/items/examples/foo/04 e.jpg
tinyepubbuilder.builder.INFO: making a page
  -- build.tinyepubbuilder/test/book/items/examples/foo/04 e.jpg.xhtml
tinyepubbuilder.builder.INFO: making a EPUB package
  -- build.tinyepubbuilder/test.epub
```

### tinyepubbuild --help

```
usage: tinyepubbuild [-h] [--unzipped] [-c cover-image] [-t title]
                     [-l language-tag] [-a author-name] [--id identifier]
                     [--uuid dns-name]
                     package-name

A tool to buid a epub package from a formatted file-list readable on the
standard input.

positional arguments:
  package-name          EPUB Package directory and make the file
                        <package-name>.epub

optional arguments:
  -h, --help            show this help message and exit
  --unzipped            make the package unzipped
  -c cover-image, --cover cover-image
                        used for <item properties="cover-image"
                        href="<cover-image>"/>
  -t title, --title title
                        if not, <package-name> is used for the book title
  -l language-tag, --language language-tag
                        if not, use the `lang` attribute of the content
                        documents. if there is no `lang` attribute, use the
                        `os.environ["LANG"]`
  -a author-name, --author author-name
                        used for <dc:creator> element of the package document
  --id identifier       used for <dc:identifier> element of the package
                        document
  --uuid dns-name       if the <identifier> is not specified, use this value for
                        generate the package unique identifier with
                        `uuid5(NAMESPACE_DNS, <dns-name>)`. if both are not
                        specified, generated by `uuid4()`

File-list format:
    <file-list>  ::= <entry>+
    <entry> ::= <path> [ "\t" <use-nav> [ "\t" <caption> ] ] "\n"
    <use-nav> ::= <index-title> | "-" | ""
    <caption>  ::= <content-caption> | "-"

    <path>
        A path to XHTML, SVG, or image file. That XHTML and SVG files are used
        as content documents (EPUB 3.2). Other each media file is embedded in a
        XHTML file. If you want to embed that SVG into XHTML, you should add a
        <content-caption>.
    <index-title>
        Indicates that document linked from a table of contents.
        If it is specified to "-", the title of content document, text contents,
        or the basename of the file is used as the index title.
    <content-caption>
        When the <path>'s media type is image type, this value used as a content
        of figcaption tag of the wrapping XHTML.
        if the <path> points to a SVG and this cell is specified, the SVG is
        embedded in a XHTML file. Then, if it is "-", this value is the SVG's
        title data or the basename of the file.
```

### Example of a file-list format

The following example is a tab-separated-values file that each tab is expressed `[_TAB_]` for visibility.

```
01.png[_TAB_]The first page
02.xhtml
03.svg[_TAB_]-
04.svg[_TAB_][_______TAB________]-
05.jpg[_TAB_]The last page[_TAB_]Goodbye<br/>Sayoonara
```

The above file exists at [tests/assets/spine.tsv](tests/assets/spine.tsv). And you can build this as follows:

```
% tinyepubbuild test < tests/assets/spine.tsv
```

then the EPUB Package will be made at the `tests/assets/build/test.epub`.

#### Package Document


#### Navigation Document
